<!DOCTYPE html>
<html>
<head>
  <title>投票結果</title>
</head>
<body>
  <h1>投票結果</h1>
  <div id="results">
    <p>A: <span id="resultA">0</span>票</p>
    <p>B: <span id="resultB">0</span>票</p>
    <p>C: <span id="resultC">0</span>票</p>
    <p>D: <span id="resultD">0</span>票</p>
  </div>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyOP1ovz6ue8HltwQUKKVzLr1NqXRBjIy70W6_DvDWkA_gTIXjLZtVj1a9GBd-BDzzW9A/exec';

    function fetchResults() {
      fetch(scriptURL)
        .then(response => {
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          return response.json();
        })
        .then(data => {
          // データが存在しない場合のフォールバック
          document.getElementById('resultA').innerText = data['A'] || 0;
          document.getElementById('resultB').innerText = data['B'] || 0;
          document.getElementById('resultC').innerText = data['C'] || 0;
          document.getElementById('resultD').innerText = data['D'] || 0;
        })
        .catch(error => {
          console.error('Error fetching results!', error);
          alert('投票結果の取得に失敗しました。');
        });
    }

    // ページ読み込み時に結果を取得
    fetchResults();
    // 5秒ごとに更新
    setInterval(fetchResults, 5000);
  </script>
</body>
</html>
